Звіт про виконання Лабораторної роботи №6

Вступ
Метою цієї роботи було опанування інструментів міграції Prisma ORM для керування змінами в схемі бази даних. Оскільки робота виконувалася на базі існуючого проєкту (Лабораторна робота №5) з наявними даними, ключовим етапом було налаштування базової міграції (Baselining) для збереження цілісності даних.

1. Ініціалізація та Baselining (0_init)
База даних вже містила таблиці з даними . Прямий запуск prisma migrate dev призвів би до очищення бази. Тому було виконано процедуру "Baselining" — створення початкової точки відліку.

Що робили

Зчитано існуючу структуру бази даних у файл схеми командою npx prisma db pull.

Згенеровано SQL-скрипт для створення поточних таблиць командою npx prisma migrate diff.

Створено міграцію 0_init та вручну позначено її як виконану, щоб Prisma не намагалася перестворити існуючі таблиці.

npx prisma migrate resolve --applied 0_init

2. Додавання нової таблиці (add-review-table)
Завдання: Додати нову сутність Review (Відгуки) та зв'язати її з продуктами.

Зміни у schema.prisma: Додано нову модель Review з полями rating, comment, productId. У модель product додано поле зворотного зв'язку Review Review[].

 Створено нову таблицю в БД, старі дані  залишилися без змін.
![alt text](<Screenshot 2025-12-13 024825.png>)
3. Зміна існуючої таблиці (add-active-field)
Завдання: Додати поле is_active до таблиці product для керування видимістю товарів.

Зміни у schema.prisma: У модель product додано поле: is_active Boolean @default(true)

 Усі існуючі товари отримали статус true (активні) автоматично завдяки дефолтному значенню.
 ![alt text](<Screenshot 2025-12-13 024906.png>)

4. Видалення стовпця (drop-column)
Завдання: Видалити поле description з таблиці product для оптимізації.

Зміни у schema.prisma: Рядок description String? було видалено з моделі product.

Стовпець фізично видалено з таблиці бази даних.
![alt text](<Screenshot 2025-12-13 025115.png>)
5. Результати та перевірка
Для перевірки коректності застосованих міграцій використано Prisma Studio.

Докази роботи:

Таблиця Review успішно відображається у списку моделей.

У таблиці product присутній стовпець is_active.

Стовпець description відсутній.

![alt text](<Screenshot 2025-12-13 024825-1.png>)

Висновок
У ході лабораторної роботи було налаштовано процес міграцій Prisma ORM для існуючої бази даних PostgreSQL. Реалізовано повний цикл змін без втрати даних користувачів.

Всі використані команди по порядку -
npm init -y

npm install prisma --save-dev

npx prisma init

npx prisma db pull

New-Item -Path "prisma\migrations\0_init" -ItemType Directory -Force

New-Item -Path "prisma\migrations\0_init\migration.sql" -ItemType File -Force

npx prisma migrate diff --from-empty --to-schema prisma/schema.prisma --script

npx prisma migrate resolve --applied 0_init

npx prisma migrate dev --name add-review-table

npx prisma migrate dev --name add-active-field

npx prisma migrate dev --name drop-description

npx prisma studio